2025-04-30 09:50:00,322 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 09:50:00,460 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 09:51:23,130 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione ricerca_avanzata_possessori(unknown) non esiste
LINE 1: SELECT * FROM ricerca_avanzata_possessori('fossati')
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 09:51:23,131 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 09:51:23,132 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM ricerca_avanzata_possessori('fossati')"
2025-04-30 09:51:23,133 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 09:51:23,134 - CatastoDB - WARNING - Funzione 'ricerca_avanzata_possessori' non trovata.
2025-04-30 09:55:45,633 - CatastoDB - INFO - Disconnessione completata
2025-04-30 10:40:05,968 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 10:40:06,086 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 10:44:16,871 - CatastoDB - INFO - Disconnessione completata
2025-04-30 10:49:25,714 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 10:49:25,786 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 10:50:06,801 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-04-30 10:50:06,828 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione ricerca_avanzata_immobili(integer, unknown, unknown, unknown, unknown) non esiste
LINE 1: SELECT * FROM ricerca_avanzata_immobili(3, 'casa', NULL, NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 10:50:06,828 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 10:50:06,829 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM ricerca_avanzata_immobili(3, 'casa', NULL, NULL, NULL)"
2025-04-30 10:50:06,830 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 10:50:06,830 - CatastoDB - WARNING - Funzione 'ricerca_avanzata_immobili' non trovata.
2025-04-30 11:14:46,289 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:14:46,492 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:14:58,774 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-04-30 11:23:24,592 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 4) inserita con ID: 7
2025-04-30 11:24:14,683 - CatastoDB - INFO - Localit‡ 'Regione Poca' (Comune ID: 4) inserita con ID: 8
2025-04-30 11:24:30,590 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:24:30,592 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 11:24:30,592 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_nuova_proprieta(4, 99, \'2025-04-01\'::date, \'[{"nome_completo": "Santoro Marco di Pasquale", "cognome_nome": "Santoro Marco", "paternita": "di Pasquale"}]\'::json, \'[{"natura": "Casa", "localita_id": 7, "classificazione": null, "numero_piani": 2, "numero_vani": 2, "consistenza": "120"}, {"natura": "Casa", "localita_id": 8, "classificazione": null, "numero_piani": null, "numero_vani": null, "consistenza": null}]\'::json)'
2025-04-30 11:24:30,593 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:24:30,593 - CatastoDB - ERROR - Errore DB registrazione nuova propriet‡ (Partita 99): ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:33:22,797 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:33:25,824 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:33:25,898 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:34:25,191 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 4) inserita con ID: 9
2025-04-30 11:34:35,875 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:34:35,876 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 11:34:35,876 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_nuova_proprieta(4, 99, \'2025-04-01\'::date, \'[{"nome_completo": "Santoro Marco di Pasquale", "cognome_nome": "Santoro Marco", "paternita": "di Pasquale"}]\'::json, \'[{"natura": "casa", "localita_id": 9, "classificazione": null, "numero_piani": null, "numero_vani": null, "consistenza": null}]\'::json)'
2025-04-30 11:34:35,877 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:34:35,878 - CatastoDB - ERROR - Errore DB registrazione nuova propriet‡ (Partita 99): ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:35:04,462 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:35:38,140 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:35:38,209 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:37:02,260 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 3) inserita con ID: 7
2025-04-30 11:37:10,781 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 3, Partita N.99
2025-04-30 11:38:46,937 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:38:46,937 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:38:46,938 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Vendita', '2025-01-01'::date, NULL, NULL, NULL)"
2025-04-30 11:38:46,938 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:38:46,939 - __main__ - ERROR - Errore non gestito nel menu principale: type object 'RaiseException' has no attribute 'sqlstate'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 517, in insert_contratto
    if self.execute_query(call_proc, params): self.commit(); logger.info(f"Contratto inserito per variazione ID {variazione_id}."); return True
       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 162, in execute_query
    raise db_err # RILANCIA l'eccezione per gestione specifica nel chiamante
    ^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 140, in execute_query
    self.cur.execute(query, params)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\saint\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\extras.py", line 146, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.RaiseException: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 300, in menu_principale
    elif scelta == "2": menu_inserimento(db)
                        ~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 576, in menu_inserimento
    elif scelta == "7": _inserisci_contratto_interattivo(db)   # Invariato
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 779, in _inserisci_contratto_interattivo
    if db.insert_contratto(var_id, tipo_contr, data_contr, notaio, repertorio, note): print(f"Contratto inserito per Variazione ID {var_id}.")
       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 520, in insert_contratto
    if hasattr(db_err, 'pgcode') and db_err.pgcode == psycopg2.errors.RaiseException.sqlstate and 'Esiste gi‡ un contratto' in str(db_err): logger.warning(f"Contratto per variazione ID {variazione_id} esiste gi‡.")
                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RaiseException' has no attribute 'sqlstate'
2025-04-30 11:38:47,037 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:45:42,033 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:45:42,140 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:45:59,486 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:45:59,486 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:45:59,486 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Vendita', '2025-04-01'::date, NULL, NULL, NULL)"
2025-04-30 11:45:59,487 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:45:59,487 - CatastoDB - ERROR - Errore DB inserimento contratto var ID 1: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:48:05,993 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:48:23,618 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:48:23,816 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:48:42,330 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:48:42,330 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:48:42,331 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Successione', '2025-01-01'::date, NULL, NULL, NULL)"
2025-04-30 11:48:42,331 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:48:42,332 - CatastoDB - ERROR - Errore DB inserimento contratto var ID 1: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:49:49,821 - CatastoDB - INFO - Partita ID 1 duplicata in N.999.
2025-04-30 11:50:51,444 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedColumn - ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 24 a assegnazione

2025-04-30 11:50:51,444 - CatastoDB - ERROR - SQLSTATE: 42703
2025-04-30 11:50:51,444 - CatastoDB - ERROR - Query renderizzata: b'SELECT genera_certificato_proprieta(1) AS certificato'
2025-04-30 11:50:51,445 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:50:51,445 - CatastoDB - ERROR - Errore DB gen cert prop (ID: 1): ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 24 a assegnazione

2025-04-30 11:55:15,451 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:55:32,427 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:55:32,495 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:55:36,184 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedColumn - ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 17 a assegnazione

2025-04-30 11:55:36,184 - CatastoDB - ERROR - SQLSTATE: 42703
2025-04-30 11:55:36,185 - CatastoDB - ERROR - Query renderizzata: b'SELECT genera_certificato_proprieta(1) AS certificato'
2025-04-30 11:55:36,186 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:55:36,186 - CatastoDB - ERROR - Errore DB gen cert prop (ID: 1): ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 17 a assegnazione

2025-04-30 11:55:50,315 - CatastoDB - INFO - Disconnessione completata
2025-05-02 18:32:35,377 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-02 18:32:35,470 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-02 18:36:02,083 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Backup ID 1 non trovato
CONTEXT:  funzione PL/pgSQL get_restore_commands(integer) riga 9 a RAISE

2025-05-02 18:36:02,083 - CatastoDB - ERROR - SQLSTATE: P0001
2025-05-02 18:36:02,084 - CatastoDB - ERROR - Query renderizzata: b'SELECT get_restore_commands(1) AS command'
2025-05-02 18:36:02,085 - CatastoDB - INFO - Rollback eseguito.
2025-05-02 18:36:02,085 - CatastoDB - ERROR - Errore DB get_restore_cmd (ID: 1): ERRORE:  Backup ID 1 non trovato
CONTEXT:  funzione PL/pgSQL get_restore_commands(integer) riga 9 a RAISE

2025-05-02 18:36:20,055 - CatastoDB - INFO - Disconnessione completata
2025-05-03 08:05:18,224 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 08:05:18,322 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 08:07:20,909 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-03 08:10:22,632 - CatastoDB - INFO - Immobile ID 1100 trasferito a partita ID 1300.
2025-05-03 08:16:20,436 - CatastoDB - INFO - Disconnessione completata
2025-05-03 21:24:27,701 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 21:24:27,811 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 21:25:14,640 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-03 21:25:14,739 - CatastoDB - INFO - Disconnessione completata
2025-05-03 21:25:36,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 21:25:36,348 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 21:25:42,280 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:25:42,281 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:25:42,281 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-03 21:25:42,282 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:25:42,282 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:25:56,889 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-03 21:25:57,519 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-03 21:26:06,730 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-03 21:26:07,273 - CatastoDB - INFO - Manutenzione (ANALYZE, REFRESH MV) completata.
2025-05-03 21:26:22,292 - CatastoDB - WARNING - La funzione SQL 'analizza_query_lente' potrebbe non essere definita.
2025-05-03 21:26:22,296 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione analizza_query_lente(integer) non esiste
LINE 1: SELECT * FROM analizza_query_lente(1000)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:22,297 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:22,297 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM analizza_query_lente(1000)'
2025-05-03 21:26:22,298 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:22,299 - CatastoDB - WARNING - Funzione 'analizza_query_lente' non trovata.
2025-05-03 21:26:31,898 - CatastoDB - WARNING - La procedura SQL 'controlla_frammentazione_indici' potrebbe non essere definita.
2025-05-03 21:26:31,899 - CatastoDB - INFO - Avvio controllo frammentazione indici (risultati nei log DB)...
2025-05-03 21:26:31,901 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura controlla_frammentazione_indici() non esiste
LINE 1: CALL controlla_frammentazione_indici()
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:31,901 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:31,901 - CatastoDB - ERROR - Query renderizzata: b'CALL controlla_frammentazione_indici()'
2025-05-03 21:26:31,902 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:31,903 - CatastoDB - WARNING - Procedura 'controlla_frammentazione_indici' non trovata.
2025-05-03 21:26:41,752 - CatastoDB - WARNING - La funzione SQL 'suggerimenti_ottimizzazione' potrebbe non essere definita o corretta.
2025-05-03 21:26:41,753 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione suggerimenti_ottimizzazione() non esiste
LINE 1: SELECT suggerimenti_ottimizzazione() AS suggestions
               ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:41,754 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:41,755 - CatastoDB - ERROR - Query renderizzata: b'SELECT suggerimenti_ottimizzazione() AS suggestions'
2025-05-03 21:26:41,755 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:41,756 - CatastoDB - WARNING - Funzione 'suggerimenti_ottimizzazione' non trovata.
2025-05-03 21:27:08,485 - __main__ - WARNING - Login fallito (utente 'Saintgold' non trovato/attivo).
2025-05-03 21:27:27,589 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:10:36,884 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:10:37,007 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:11:46,941 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-12 18:11:46,942 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-12 18:11:46,943 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-12 18:11:46,944 - CatastoDB - INFO - Rollback eseguito.
2025-05-12 18:11:46,945 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-12 18:12:04,184 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:14:20,143 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:14:20,459 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:14:56,569 - CatastoDB - INFO - Immobile ID 1 trasferito a partita ID 2.
2025-05-12 18:17:58,632 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:19:59,733 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:19:59,830 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:21:41,682 - CatastoDB - INFO - Localit‡ 'Regione Pizzaballa' (Comune ID: 6) inserita con ID: 101
2025-05-12 18:23:28,117 - CatastoDB - INFO - Localit‡ 'Regione Pizzaballa' (Comune ID: 6) inserita con ID: 102
2025-05-12 18:23:56,290 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 6, Partita N.999
2025-05-12 18:27:00,135 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  [registra_passaggio_proprieta] Errore: La partita 999 gi√† esiste nel comune ID 6
CONTEXT:  funzione PL/pgSQL registra_passaggio_proprieta(integer,integer,integer,character varying,date,character varying,date,character varying,character varying,json,integer[],text) riga 79 a RAISE

2025-05-12 18:27:00,135 - CatastoDB - ERROR - SQLSTATE: P0001
2025-05-12 18:27:00,135 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_passaggio_proprieta(1, 6, 999, \'Vendita\', \'2025-05-01\'::date, \'Vendita\', \'1950-05-01\'::date, \'Licia Col\xc3\xb2\', NULL, \'[{"nome_completo": "Alfredo O\'\'Chiatt", "cognome_nome": "Chiatto Alfredo", "paternita": "di Apulio"}]\'::json, NULL, NULL)'
2025-05-12 18:27:00,136 - CatastoDB - INFO - Rollback eseguito.
2025-05-12 18:27:00,136 - CatastoDB - ERROR - Errore DB registrazione passaggio propriet‡ (Origine ID 1): ERRORE:  [registra_passaggio_proprieta] Errore: La partita 999 gi√† esiste nel comune ID 6
CONTEXT:  funzione PL/pgSQL registra_passaggio_proprieta(integer,integer,integer,character varying,date,character varying,date,character varying,character varying,json,integer[],text) riga 79 a RAISE

2025-05-13 08:48:22,911 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 08:48:23,091 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 08:48:45,045 - CatastoDB - INFO - Disconnessione completata
2025-05-13 09:43:16,790 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 09:43:16,896 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 09:51:46,449 - CatastoDB - INFO - Disconnessione completata
2025-05-13 10:01:22,527 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 10:01:22,595 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 10:09:03,380 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-13 10:09:03,394 - CatastoDB - INFO - Disconnessione completata
2025-05-13 10:12:51,820 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 10:12:51,994 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 10:13:12,102 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione get_record_history(unknown, integer) non esiste
LINE 1: SELECT * FROM get_record_history('partita', 1)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-13 10:13:12,102 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-13 10:13:12,103 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM get_record_history('partita', 1)"
2025-05-13 10:13:12,104 - CatastoDB - INFO - Rollback eseguito.
2025-05-13 10:13:12,104 - CatastoDB - ERROR - Errore DB get_record_history: ERRORE:  la funzione get_record_history(unknown, integer) non esiste
LINE 1: SELECT * FROM get_record_history('partita', 1)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-13 10:13:22,239 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-13 10:13:22,240 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-13 10:13:22,240 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 1000'
2025-05-13 10:13:22,246 - CatastoDB - INFO - Rollback eseguito.
2025-05-13 10:13:22,246 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-14 09:55:16,355 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 09:55:16,527 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 09:55:28,980 - CatastoDB - INFO - Disconnessione completata
2025-05-14 10:16:44,158 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:16:44,263 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:17:07,541 - __main__ - WARNING - Login fallito (utente 'postgres' non trovato/attivo).
2025-05-14 10:18:00,122 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:18:00,174 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:32:39,817 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-14 10:54:27,621 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:54:27,680 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:55:12,311 - CatastoDB - INFO - Utente 'antongiulio' creato.
2025-05-14 10:55:27,476 - __main__ - INFO - Login OK per ID: 3
2025-05-14 10:55:27,480 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-14 10:55:27,481 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-14 10:55:27,481 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '9fdf65fd-98b3-46fc-9e86-c990084bb894', 'CatastoApp')"
2025-05-14 10:55:27,482 - CatastoDB - INFO - Rollback eseguito.
2025-05-14 10:55:27,482 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 3: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-14 10:55:29,044 - __main__ - ERROR - Login OK per ID 3 ma fallita reg. accesso.
2025-05-14 10:55:49,592 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:55:49,750 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:55:51,459 - CatastoDB - INFO - Disconnessione completata
2025-05-15 09:08:19,236 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 09:08:19,345 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 09:08:50,068 - CatastoDB - INFO - Disconnessione completata
2025-05-15 10:18:20,492 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 10:18:20,603 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 10:21:01,331 - CatastoDB - INFO - Disconnessione completata
2025-05-15 16:55:33,006 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 16:55:33,095 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 16:56:11,070 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-15 16:56:22,579 - __main__ - INFO - Login OK per ID: 2
2025-05-15 16:56:22,585 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 16:56:22,585 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 16:56:22,585 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, 'e02a0de5-7f71-4a76-a1da-cb381ca3ee72', 'CatastoApp')"
2025-05-15 16:56:22,586 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 16:56:22,586 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 2: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 16:56:26,096 - __main__ - ERROR - Login OK per ID 2 ma fallita reg. accesso.
2025-05-15 17:02:18,921 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 1, Partita N.1
2025-05-15 17:04:18,647 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-15 17:04:18,780 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-15 17:04:34,619 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:00:37,205 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:00:37,305 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:03:39,684 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-15 18:05:51,731 - CatastoDB - INFO - Immobile ID 1 trasferito a partita ID 2.
2025-05-15 18:07:17,550 - CatastoDB - ERROR - Errore DB specifico rilevato: UniqueViolation - ERRORE:  un valore chiave duplicato viola il vincolo univoco "utente_username_key"
DETAIL:  La chiave (username)=(pippo) esiste gi‡.
CONTEXT:  istruzione SQL "INSERT INTO utente (username, password_hash, nome_completo, email, ruolo)
    VALUES (p_username, p_password, p_nome_completo, p_email, p_ruolo)"
funzione PL/pgSQL crea_utente(character varying,character varying,character varying,character varying,character varying) riga 3 a istruzione SQL

2025-05-15 18:07:17,550 - CatastoDB - ERROR - SQLSTATE: 23505
2025-05-15 18:07:17,550 - CatastoDB - ERROR - Query renderizzata: b"CALL crea_utente('pippo', '$2b$12$ATiRsJFv4Mw6Td5vgLvWWOruhEeLgQ9S/42/88D7txmAAAkMhVJ.6', 'pippo', 'pippo', 'admin')"
2025-05-15 18:07:17,551 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:07:17,551 - CatastoDB - ERROR - Errore creazione utente: Username 'pippo' o Email 'pippo' gi‡ esistente.
2025-05-15 18:07:44,539 - __main__ - INFO - Login OK per ID: 2
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:07:44,541 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '31b9fbfa-04dc-425f-ad2c-b5c143d22f51', 'CatastoApp')"
2025-05-15 18:07:44,541 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 2: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:07:44,542 - __main__ - ERROR - Login OK per ID 2 ma fallita reg. accesso.
2025-05-15 18:09:37,413 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:32:26,289 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:32:26,351 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:32:36,745 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-15 18:32:36,759 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:32:44,936 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:32:45,010 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:32:57,108 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 18:33:24,388 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-15 18:33:40,850 - __main__ - INFO - Login OK per ID: 3
2025-05-15 18:33:40,854 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione e367fbab...
2025-05-15 18:41:26,163 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:41:26,164 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:41:26,164 - CatastoDB - ERROR - Query renderizzata: b"CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5', '127.0.0.1')"
2025-05-15 18:41:26,164 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:41:26,164 - CatastoDB - ERROR - Errore DB logout utente ID 3: ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:41:26,165 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:41:36,961 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:41:37,022 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:41:55,561 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-15 18:51:26,975 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-15 18:51:37,558 - __main__ - INFO - Login OK per ID: 4
2025-05-15 18:51:37,560 - CatastoDB - INFO - Registrato accesso: Utente ID 4, Azione login, Esito True, Sessione cea5427e...
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:51:57,181 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Query renderizzata: b"CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27', '127.0.0.1')"
2025-05-15 18:51:57,181 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Errore DB logout utente ID 4: ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:51:57,182 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:58:36,051 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:58:36,114 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:58:38,358 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:58:47,269 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:58:47,331 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:59:06,467 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-15 19:00:21,099 - CatastoDB - INFO - Registrata consultazione: Richiedente 'Antongiulio', Data 2025-05-15
2025-05-15 19:01:01,878 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1439, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-15 19:01:01,893 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:01:49,728 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:01:49,790 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:02:02,792 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:02:02,803 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione ab67a918...
2025-05-15 19:06:08,632 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione ab67a918...
2025-05-15 19:06:08,632 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:06:19,457 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:06:19,518 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:06:30,804 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:06:31,024 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:06:31,040 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 15dcd4f7...
2025-05-15 19:14:06,321 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 15dcd4f7...
2025-05-15 19:14:06,322 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:14:10,535 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:14:10,597 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:14:28,837 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:14:29,059 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:14:29,070 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 525ef173...
2025-05-15 19:18:46,143 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:46,149 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione d9bbb2bc...
2025-05-15 19:18:48,207 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:48,208 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione bea41487...
2025-05-15 19:18:51,391 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:51,392 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 342dbddc...
2025-05-15 19:18:59,415 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:59,421 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 7a5ab7da...
2025-05-15 19:19:04,920 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 7a5ab7da...
2025-05-15 19:19:04,921 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:19:07,809 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:19:07,978 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:19:29,569 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:19:29,789 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:19:29,818 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 4ddb62ce...
2025-05-15 19:19:42,383 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:42,384 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione db86bb78...
2025-05-15 19:19:47,687 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:47,688 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione f333211d...
2025-05-15 19:19:50,288 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:50,293 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione e19876ef...
2025-05-15 19:20:04,463 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:04,464 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 367dbf16...
2025-05-15 19:20:14,567 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:14,573 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione ac97f7a4...
2025-05-15 19:20:16,655 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:16,656 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 6720ba51...
2025-05-15 19:20:22,951 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:22,952 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 47816622...
2025-05-15 19:26:36,147 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:26:36,153 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 78ecdfe7...
2025-05-15 19:26:37,710 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 78ecdfe7...
2025-05-15 19:26:37,712 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:27:30,067 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:27:30,227 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:27:38,409 - CatastoDB - INFO - Disconnessione completata
2025-05-16 15:50:16,398 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 15:50:16,506 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 15:50:23,862 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 15:50:24,294 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 7fe0f6b5...
2025-05-16 15:50:58,203 - __main__ - INFO - Uscita inattesa da menu_principale con utente ancora loggato. Terminazione.
2025-05-16 16:05:54,704 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:05:54,776 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:06:02,540 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 16:06:02,893 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 4764c31e...
2025-05-16 16:06:13,014 - CatastoDB - INFO - Disconnessione completata
2025-05-16 16:06:15,780 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:06:15,847 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:06:22,098 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 16:06:22,499 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 1efdf3e3...
2025-05-16 16:06:33,594 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-16 16:06:33,594 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-16 16:06:33,595 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 100'
2025-05-16 16:06:33,595 - CatastoDB - INFO - Rollback eseguito.
2025-05-16 16:06:33,596 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-16 16:07:34,241 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-16 16:26:25,654 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:26:25,889 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:27:50,640 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 16:28:14,694 - CatastoDB - INFO - Disconnessione completata
2025-05-16 16:34:05,083 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:34:05,195 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:34:21,117 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 16:35:23,986 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:35:24,091 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:35:26,019 - CatastoDB - INFO - Disconnessione completata
2025-05-16 17:20:21,722 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 17:20:21,936 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 17:22:51,384 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 17:22:51,614 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 17:22:56,590 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:04,689 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:09,328 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:09,343 - CatastoDB - INFO - Disconnessione completata
2025-05-16 18:31:04,322 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 18:31:04,528 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 18:31:10,973 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-16 18:31:11,065 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-16 18:31:11,157 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-16 18:31:11,257 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 8fcda1f7...
2025-05-16 18:31:27,787 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-16 18:31:40,419 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 18:31:40,519 - CatastoDB - INFO - Disconnessione completata
2025-05-16 18:31:58,196 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 18:31:58,343 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 18:32:09,421 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-16 18:32:09,426 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-16 18:32:09,433 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-16 18:32:09,441 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 506e56e1...
2025-05-16 18:32:15,606 - CatastoDB - INFO - Disconnessione completata
2025-05-17 07:38:34,710 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 07:38:34,850 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 07:38:43,239 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 07:38:44,269 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione d326ab53...
2025-05-17 07:40:24,653 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1045, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 365, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-17 07:40:24,764 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione d326ab53...
2025-05-17 07:40:24,766 - CatastoDB - INFO - Disconnessione completata
2025-05-17 07:40:42,226 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 07:40:42,308 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 07:40:47,416 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 07:40:48,340 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 3b8b1a59...
2025-05-17 07:41:01,982 - CatastoDB - INFO - Recuperati 4 utenti.
2025-05-17 07:41:32,824 - CatastoDB - INFO - Disconnessione completata
2025-05-17 08:09:28,930 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 08:09:29,098 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 08:09:34,693 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 08:09:35,608 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione c8a9ed1c...
2025-05-17 08:10:25,737 - CatastoDB - INFO - Recuperati 4 utenti.
2025-05-17 08:11:08,516 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 08:11:08,516 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 08:11:08,517 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 08:11:08,519 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 1a52a2cc...
2025-05-17 08:11:15,447 - CatastoDB - INFO - Credenziali recuperate per utente: sa
2025-05-17 08:11:16,370 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 470f2a75...
2025-05-17 08:12:50,871 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-17 08:12:50,873 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-17 08:12:50,874 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-17 08:12:50,875 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 08:12:50,876 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-17 08:13:36,344 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-17 08:13:36,345 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-17 08:13:36,345 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 100'
2025-05-17 08:13:36,346 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 08:13:36,346 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-17 08:15:05,561 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:37:28,649 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:37:28,785 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:37:33,759 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 10:37:42,947 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 10:37:45,803 - __main__ - WARNING - Login fallito (utente 'sa' non trovato/attivo).
2025-05-17 10:37:45,810 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:37:49,738 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:37:49,950 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:37:58,150 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:37:58,155 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:37:58,161 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:37:58,187 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 726ef06b...
2025-05-17 10:38:05,891 - __main__ - WARNING - Login fallito (utente 'Admin' non trovato/attivo).
2025-05-17 10:38:08,590 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:46:02,315 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:46:02,429 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:46:07,756 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:46:07,762 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:46:07,767 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:46:07,776 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione ee1520c8...
2025-05-17 10:47:51,238 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:49:32,624 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:49:32,838 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:49:38,414 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:49:38,419 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:49:38,425 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:49:38,435 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione a6b9839b...
2025-05-17 10:49:43,918 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:55:55,175 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:55:55,288 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:56:01,153 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:01,158 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:01,164 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:01,173 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 5420aba4...
2025-05-17 10:56:19,359 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:19,365 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:19,370 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:19,377 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 69f6dc22...
2025-05-17 10:56:30,311 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:30,317 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:30,323 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:30,329 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 2fa2180c...
2025-05-17 10:56:30,338 - CatastoDB - INFO - Disconnessione completata
2025-05-17 11:12:53,920 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 11:12:54,160 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 11:12:59,079 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:12:59,335 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 11:12:59,344 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 60c27911...
2025-05-17 11:13:13,917 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:13:14,194 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 11:13:14,201 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 5b821f4a...
2025-05-17 11:13:18,975 - CatastoDB - INFO - Disconnessione completata
2025-05-17 11:30:29,297 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 11:30:29,415 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 11:30:35,851 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:30:36,114 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 76495234...
2025-05-17 12:32:06,194 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:32:10,796 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:32:10,966 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:32:21,770 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:32:51,118 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:32:51,229 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:32:55,842 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:32:55,865 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 12:32:55,881 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 12:32:55,913 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 38a8a2d6...
2025-05-17 12:33:13,907 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:58:24,947 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:58:25,114 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:58:30,362 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:58:30,627 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 39443c3d...
2025-05-17 12:58:42,609 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:59:23,405 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:59:23,622 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:59:27,827 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:59:28,091 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 898a5ae2...
2025-05-17 12:59:44,032 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-17 13:09:16,531 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:10:16,820 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:10:17,037 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:10:20,905 - __main__ - ERROR - Errore non gestito nel programma: 'CatastoDBManager' object has no attribute 'get_user_credentials'
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 1255, in main
    if not esegui_login(db):
           ~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\python_example.py", line 159, in esegui_login
    credentials = db.get_user_credentials(username_login) # Assumiamo restituisca id, username, password_hash, nome_completo
                  ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_user_credentials'
2025-05-17 13:10:21,057 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:11:45,117 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:11:45,246 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:11:50,261 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 13:11:50,522 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1bd89b5d...
2025-05-17 13:12:53,254 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:12:55,982 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:12:56,200 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:13:00,727 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 13:13:00,987 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 13f3bedd...
2025-05-17 13:13:37,321 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-17 13:13:52,359 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 13:14:33,554 - __main__ - ERROR - Errore non gestito nel programma: _seleziona_utente_da_elenco() got an unexpected keyword argument 'exclude_user_id'
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 1259, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\python_example.py", line 1219, in menu_principale
    utente_ancora_loggato = menu_utenti(db) # menu_utenti ora restituisce False se l'utente fa logout
  File "U:\catasto\gemini\python_example.py", line 1113, in menu_utenti
    user_id_to_toggle = _seleziona_utente_da_elenco(db, "Seleziona l'utente da disattivare/riattivare:", exclude_user_id=logged_in_user_id)
TypeError: _seleziona_utente_da_elenco() got an unexpected keyword argument 'exclude_user_id'
2025-05-17 13:14:33,701 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 13f3bedd...
2025-05-17 13:14:33,707 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:18:00,436 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:18:00,573 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:18:05,067 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 13:18:05,342 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 5ad54c9c...
2025-05-17 13:18:09,569 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 13:18:39,153 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:15:09,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:15:09,342 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:15:14,404 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 15:15:14,670 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9d865890...
2025-05-17 15:15:26,824 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 15:16:00,654 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-17 15:16:08,584 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:16:17,609 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:40:23,007 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:40:23,120 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:40:27,435 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: pippo, Ruolo: consultatore
2025-05-17 15:40:27,710 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 791271c0...
2025-05-17 15:40:35,707 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:40:55,999 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 791271c0...
2025-05-17 15:41:04,370 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 15:41:04,628 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 981daba6...
2025-05-17 15:41:13,452 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:41:40,616 - CatastoDB - INFO - Dettagli utente ID 3 aggiornati.
2025-05-17 15:41:49,265 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:42:18,129 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:42:33,527 - CatastoDB - INFO - Password resettata per utente ID 3.
2025-05-17 15:42:40,823 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 981daba6...
2025-05-17 15:42:43,461 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:42:48,084 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:42:48,294 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:42:53,920 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: pippo, Ruolo: archivista
2025-05-17 15:42:54,182 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 9210f438...
2025-05-17 15:43:54,538 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 9210f438...
2025-05-17 15:44:03,551 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 15:44:03,812 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 9e449315...
2025-05-17 15:44:19,380 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:44:25,139 - CatastoDB - INFO - Utente ID 3 disattivato.
2025-05-17 15:44:45,806 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:44:52,338 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 9e449315...
2025-05-17 15:45:00,335 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 15:45:44,623 - CatastoDB - INFO - Disconnessione completata
2025-05-17 16:39:05,827 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 16:39:06,076 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 16:39:12,579 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 16:39:12,851 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9ceef3a7...
2025-05-17 16:39:30,844 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 16:39:47,140 - CatastoDB - ERROR - Errore DB specifico rilevato: ForeignKeyViolation - ERRORE:  l'istruzione UPDATE o DELETE sulla tabella "utente" viola il vincolo di chiave esterna "accesso_log_utente_id_fkey" sulla tabella "accesso_log"
DETAIL:  La chiave (id)=(3) Ë ancora referenziata dalla tabella "accesso_log".

2025-05-17 16:39:47,146 - CatastoDB - ERROR - SQLSTATE: 23503
2025-05-17 16:39:47,151 - CatastoDB - ERROR - Query renderizzata: b'DELETE FROM utente WHERE id = 3'
2025-05-17 16:39:47,157 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 16:39:47,162 - CatastoDB - ERROR - Errore DB durante l'eliminazione fisica dell'utente ID 3: ERRORE:  l'istruzione UPDATE o DELETE sulla tabella "utente" viola il vincolo di chiave esterna "accesso_log_utente_id_fkey" sulla tabella "accesso_log"
DETAIL:  La chiave (id)=(3) Ë ancora referenziata dalla tabella "accesso_log".

2025-05-17 16:39:47,168 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 16:42:02,140 - CatastoDB - INFO - Disconnessione completata
2025-05-17 16:44:38,584 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 16:44:38,701 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 16:44:44,992 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 16:44:45,252 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 629b832d...
2025-05-17 16:45:15,691 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-17 16:45:28,578 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 16:45:43,297 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 16:45:56,940 - CatastoDB - INFO - Utente ID 2 eliminato fisicamente con successo.
2025-05-17 16:46:39,938 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-17 16:48:29,107 - __main__ - INFO - Uscita inattesa da menu_principale con utente ancora loggato. Terminazione.
2025-05-17 16:48:29,117 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 629b832d...
2025-05-17 16:48:29,124 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:34:21,888 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:34:22,022 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:34:28,971 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:34:29,232 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1e6f20ed...
2025-05-17 18:34:53,935 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 1e6f20ed...
2025-05-17 18:35:06,271 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:38:33,965 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:38:34,078 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:38:39,024 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:38:39,289 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b1b57cd0...
2025-05-17 18:49:13,664 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:49:41,725 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:49:41,838 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:49:51,409 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:49:51,671 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 96252fa3...
2025-05-17 18:50:30,053 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 318, in _esporta_partita_pdf
    pdf.chapter_body({
    ~~~~~~~~~~~~~~~~^^
        'ID Partita': p.get('id'), 'Comune': p.get('comune_nome'),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        'Data Chiusura': p.get('data_chiusura')
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    })
    ^^
  File "U:\catasto\gemini\python_example.py", line 289, in chapter_body
    self.multi_cell(0, 5, f"{key.replace('_', ' ').title()}: {value if value is not None else 'N/D'}")
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 221, in wrapper
    return fn(self, *args, **kwargs)
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\deprecation.py", line 32, in wrapper
    return fn(self, *args, **kwargs)
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 4172, in multi_cell
    text_line = multi_line_break.get_line()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\line_break.py", line 792, in get_line
    raise FPDFException(
        "Not enough horizontal space to render a single character"
    )
fpdf.errors.FPDFException: Not enough horizontal space to render a single character
2025-05-17 19:52:11,842 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:52:16,838 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:52:16,952 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:52:22,137 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:52:22,400 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 45b40f39...
2025-05-17 19:52:36,112 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 323, in _esporta_partita_pdf
    pdf.add_page()
    ~~~~~~~~~~~~^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 1079, in add_page
    self.header()
    ~~~~~~~~~~~^^
  File "U:\catasto\gemini\python_example.py", line 273, in header
    self.cell(0, 10, 'Dettaglio Partita Catastale', 0, new_x=XPos.LMARGIN, new_y=YPos.NEXT, align='C')
                                                             ^^^^
NameError: name 'XPos' is not defined
2025-05-17 19:54:26,393 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:54:31,456 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:54:31,669 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:54:39,137 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:54:39,406 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 76f9ef99...
2025-05-17 19:56:23,832 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:56:29,869 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:56:29,988 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:56:34,584 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:56:34,848 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e16be22a...
2025-05-17 19:56:45,089 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 353, in _esporta_partita_pdf
    pdf.output(filename, 'F')
    ~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 19:57:03,668 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 353, in _esporta_partita_pdf
    pdf.output(filename, 'F')
    ~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 20:00:11,001 - CatastoDB - INFO - Disconnessione completata
2025-05-17 20:13:19,958 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 20:13:20,199 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 20:15:18,266 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 20:15:18,546 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6cae06e3...
2025-05-17 20:15:29,898 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 411, in _esporta_partita_pdf
    pdf.output(filename) # Rimosso 'F'
    ^^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 20:16:26,416 - CatastoDB - INFO - Disconnessione completata
2025-05-18 11:55:04,983 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:55:05,126 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:55:12,190 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 11:55:12,449 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 11:55:12,476 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b57f8306...
2025-05-18 11:57:20,078 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:57:20,188 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:57:25,245 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-18 11:57:25,257 - CatastoDB - INFO - Disconnessione completata
2025-05-18 11:57:35,034 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:57:35,172 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:57:41,273 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 11:57:41,527 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 11:57:41,536 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1e8bd154...
2025-05-18 11:57:43,223 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 11:59:50,403 - CatastoDB - INFO - Localit‡ 'Borgata Sarcazzo' (Comune ID: 3) inserita con ID: 101
2025-05-18 12:01:01,370 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 3, Partita N.1
2025-05-18 12:01:55,848 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-18 12:01:56,024 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-18 12:05:41,601 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 12:05:41,710 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 12:05:49,041 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 12:05:49,308 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 12:05:49,317 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f32db834...
2025-05-18 12:05:51,313 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:06:15,007 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-18 12:06:16,248 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-18 12:06:32,979 - CatastoDB - INFO - Utente ID 3 eliminato fisicamente con successo.
2025-05-18 12:06:33,790 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:25:51,222 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 12:25:51,372 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 12:25:59,644 - CatastoGUI - WARNING - Login GUI fallito (utente 'santoro' non trovato/attivo).
2025-05-18 12:26:09,023 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 12:26:09,290 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 12:26:09,304 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione daf1d77e...
2025-05-18 12:26:11,072 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:31:07,698 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione daf1d77e...
2025-05-18 12:31:09,337 - CatastoDB - INFO - Disconnessione completata
2025-05-18 12:31:09,346 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 14:48:08,500 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 14:48:08,644 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 14:48:16,032 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 14:48:16,282 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 14:48:16,302 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ac2bf37f...
2025-05-18 14:48:18,446 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 14:50:59,243 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione ac2bf37f...
2025-05-18 14:51:00,509 - CatastoDB - INFO - Disconnessione completata
2025-05-18 14:51:00,514 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 15:17:02,056 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 15:17:02,160 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 15:17:07,848 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 15:17:08,103 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 15:17:08,112 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6218f953...
2025-05-18 15:17:09,144 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 15:17:22,980 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-18 15:17:23,128 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-18 15:17:27,085 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-18 15:17:27,293 - CatastoDB - INFO - Manutenzione (ANALYZE, REFRESH MV) completata.
2025-05-18 15:55:50,574 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-18 15:55:50,588 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 6218f953...
2025-05-18 15:55:50,595 - CatastoDB - INFO - Disconnessione completata
2025-05-18 15:55:50,600 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 15:56:35,852 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 15:56:35,980 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 15:56:41,881 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 15:56:42,142 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione cf80e6cd...
2025-05-18 16:16:53,288 - CatastoDB - INFO - Disconnessione completata
2025-05-18 16:38:58,010 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 16:38:58,118 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 16:39:02,470 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 16:39:02,732 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 68812a4a...
2025-05-18 16:39:12,466 - CatastoDB - WARNING - Nessun dato trovato per possessore ID 1 per l'esportazione.
2025-05-18 16:39:36,326 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:13:37,487 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:13:37,644 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:13:45,809 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:13:45,810 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:13:47,350 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:13:58,391 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:13:58,391 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:13:59,371 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:03,964 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:03,965 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:04,845 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:10,901 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:10,902 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:11,789 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:13,953 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 08:14:13,962 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:14:46,584 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:14:46,679 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:14:53,596 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:53,597 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:54,776 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:59,262 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:59,263 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:59,966 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:15:03,736 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 08:15:03,741 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:18:36,245 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:18:36,350 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:18:42,778 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:18:43,137 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 08:18:43,161 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3e7e7d30...
2025-05-19 08:18:46,165 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 08:22:24,920 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3e7e7d30...
2025-05-19 08:22:26,188 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:22:26,188 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 09:08:37,870 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:08:38,002 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:08:39,805 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 09:08:39,814 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:09:14,778 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:09:14,980 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:09:23,050 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:09:23,365 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:09:23,418 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 64d56f80...
2025-05-19 09:09:25,612 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:10:15,222 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:10:15,361 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:10:22,469 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:10:22,848 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:10:22,897 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e74aae32...
2025-05-19 09:10:24,900 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:11:25,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:11:25,339 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:11:31,461 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:11:32,606 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 92c11af7...
2025-05-19 09:11:59,567 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:16:21,436 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:16:21,555 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:16:32,452 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:16:32,774 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:16:32,852 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a8d52b34...
2025-05-19 09:16:35,219 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:18:25,232 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-19 09:18:25,252 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a8d52b34...
2025-05-19 09:18:25,255 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:18:25,255 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 10:01:36,819 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:01:37,061 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:01:44,597 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 10:01:44,895 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 10:01:44,966 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione d4f9e151...
2025-05-19 10:01:46,937 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 10:02:43,539 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:02:43,608 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:02:50,067 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-19 10:02:58,556 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 10:02:59,006 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5372b372...
2025-05-19 10:03:05,129 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 10:03:37,382 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-19 10:03:42,205 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:03:52,630 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:03:55,364 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:03:55,430 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:03:58,847 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:03:59,301 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione a5920a65...
2025-05-19 10:04:06,150 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:04:09,567 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:04:09,634 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:04:14,793 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:04:15,082 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 10:04:15,089 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione c8d0e29d...
2025-05-19 10:04:16,397 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:04:46,852 - CatastoDB - INFO - Password resettata per utente ID 1.
2025-05-19 10:10:51,867 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:10:51,953 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:10:57,335 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:10:57,629 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 10:10:57,680 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 434647ec...
2025-05-19 10:10:59,213 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:11:47,354 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-19 10:11:48,623 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:12:24,748 - CatastoDB - INFO - Utente ID 3 disattivato.
2025-05-19 10:12:25,944 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:12:39,287 - CatastoDB - INFO - Dettagli utente ID 3 aggiornati.
2025-05-19 10:12:40,322 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:13:06,856 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 434647ec...
2025-05-19 10:13:08,005 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:13:08,005 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 10:37:31,433 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:37:31,514 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:37:41,395 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-19 10:37:49,198 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:37:49,609 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 021d5327...
2025-05-19 10:55:35,319 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1733, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1687, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 728, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-19 10:55:35,363 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 021d5327...
2025-05-19 10:55:35,365 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:55:38,737 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:55:38,809 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:55:42,382 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:55:42,774 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 508703e0...
2025-05-19 10:55:50,096 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1733, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1687, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 728, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-19 10:55:50,125 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 508703e0...
2025-05-19 10:55:50,128 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:58:56,621 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:58:56,704 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:59:00,355 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:59:00,754 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 936c6b79...
2025-05-19 10:59:07,027 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-19 10:59:17,077 - CatastoDB - ERROR - Errore Python imprevisto durante la ricerca avanzata dei possessori: 'CatastoDBManager' object has no attribute 'fetch_all_dict'
2025-05-19 11:02:02,115 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:02:04,894 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:02:04,963 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:02:10,217 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:02:10,638 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 45e134df...
2025-05-19 11:02:18,206 - CatastoDB - ERROR - Errore DB durante la ricerca avanzata dei possessori: ERRORE:  la funzione catasto.search_possessori_advanced(unknown, unknown, numeric) non esiste
LINE 1: SELECT * FROM catasto.search_possessori_advanced('2-97', NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-19 11:02:18,207 - CatastoDB - INFO - Rollback eseguito.
2025-05-19 11:05:11,647 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:05:32,706 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:05:32,828 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:05:36,967 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:05:37,388 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 03930a43...
2025-05-19 11:05:43,519 - CatastoDB - ERROR - Errore DB durante la ricerca avanzata dei possessori: ERRORE:  la funzione catasto.search_possessori_advanced(unknown, unknown, real) non esiste
LINE 1: SELECT * FROM catasto.search_possessori_advanced('2-97', NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-19 11:05:43,520 - CatastoDB - INFO - Rollback eseguito.
2025-05-19 11:06:01,110 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:18:57,085 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:18:57,152 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:19:00,703 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:19:01,044 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 6708e445...
2025-05-19 11:19:13,506 - CatastoDB - ERROR - Errore Python imprevisto durante la ricerca avanzata dei possessori: name 'comune_id' is not defined
2025-05-19 11:23:54,089 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:23:57,388 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:23:57,488 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:24:01,894 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:24:02,288 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione bb837c88...
2025-05-19 11:24:09,478 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.2).
2025-05-19 11:24:35,464 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.0).
2025-05-19 11:24:50,084 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.2) ha prodotto 95 risultati.
2025-05-19 11:27:22,878 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:32:36,466 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:32:36,535 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:32:44,033 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:32:44,332 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 11:32:44,340 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 4158b7fc...
2025-05-19 11:32:46,686 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 11:59:26,406 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 4158b7fc...
2025-05-19 11:59:27,937 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:59:27,937 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 12:08:48,431 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 12:08:48,545 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 12:08:56,756 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 12:08:57,050 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 12:08:57,092 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 6689471d...
2025-05-19 12:08:58,162 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 12:09:09,932 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.2).
2025-05-19 12:09:16,770 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.0).
2025-05-19 12:09:26,475 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.0) ha prodotto 95 risultati.
2025-05-19 12:09:36,759 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '3-3' (soglia: 0.0).
2025-05-19 12:09:46,799 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '3-3' (soglia: 0.0).
2025-05-19 12:10:00,957 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.0) ha prodotto 95 risultati.
2025-05-19 12:10:17,776 - CatastoDB - INFO - Ricerca avanzata possessori per '5-1 rossi' (soglia: 0.0) ha prodotto 100 risultati.
2025-05-19 12:10:47,004 - CatastoDB - INFO - Ricerca avanzata possessori per 'possessore' (soglia: 0.0) ha prodotto 100 risultati.
2025-05-19 12:10:55,721 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.0).
2025-05-19 12:10:59,494 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 1.0).
2025-05-19 12:11:09,904 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'stress' (soglia: 1.0).
2025-05-19 12:11:17,136 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.24999999999999967) ha prodotto 100 risultati.
2025-05-19 12:11:27,120 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-62' (soglia: 0.24999999999999967).
2025-05-19 12:15:33,270 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 1' (soglia: 0.24999999999999967) ha prodotto 100 risultati.
2025-05-19 12:15:43,249 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 1' (soglia: 1.0) ha prodotto 5 risultati.
